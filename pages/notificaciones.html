<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="/rana.svg" type="image/x-icon">
    <meta name="copyright" content="Manuel Casimiro Carrasco">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notificaciones - Urukais Klick</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css">
</head>
<body>
    <nav class="menu">
        <div class="menu-icon">
            <i class="fas fa-bars"></i>
        </div>
        <ul class="menu-items">
            <li><a href="../index.html"><i class="fas fa-home"></i> <span data-translate="home">Inicio</span></a></li>
            <li><a href="cronometro.html"><i class="fas fa-stopwatch"></i> <span data-translate="stopwatch">Cronómetro</span></a></li>
            <li><a href="alarma.html"><i class="fas fa-clock"></i> <span data-translate="alarm">Alarma</span></a></li>
            <li class="submenu">
                <a href="#"><i class="fas fa-palette"></i> <span data-translate="themes">Temas</span> <i class="fas fa-chevron-down"></i></a>
                <ul class="submenu-items">
                    <li><a href="#" data-theme="green"><i class="fas fa-circle"></i> <span data-translate="green">Verde</span></a></li>
                    <li><a href="#" data-theme="blue"><i class="fas fa-circle"></i> <span data-translate="blue">Azul</span></a></li>
                    <li><a href="#" data-theme="purple"><i class="fas fa-circle"></i> <span data-translate="purple">Púrpura</span></a></li>
                </ul>
            </li>
            <li class="submenu">
                <a href="#"><i class="fas fa-cog"></i> <span data-translate="settings">Configuración</span> <i class="fas fa-chevron-down"></i></a>
                <ul class="submenu-items">
                    <li><a href="sounds.html"><i class="fas fa-volume-up"></i> <span data-translate="sounds">Sonidos</span></a></li>
                    <li class="active"><a href="notificaciones.html"><i class="fas fa-bell"></i> <span data-translate="notifications">Notificaciones</span></a></li>
                    <li class="submenu">
                        <a href="#"><i class="fas fa-language"></i> <span data-translate="language">Idioma</span> <i class="fas fa-chevron-down"></i></a>
                        <ul class="submenu-items language-menu">
                            <li><a href="#" onclick="setLanguage('es')"><span class="flag-icon flag-icon-es"></span> Español</a></li>
                            <li><a href="#" onclick="setLanguage('en')"><span class="flag-icon flag-icon-gb"></span> English</a></li>
                            <li><a href="#" onclick="setLanguage('fr')"><span class="flag-icon flag-icon-fr"></span> Français</a></li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li><a href="/pages/a-cerca-de.html"><i class="fas fa-info-circle"></i> <span data-translate="about">Acerca de</span></a></li>
        </ul>
    </nav>

    <div class="contenedor">
        <h1>🐸 Notificaciones 🐸</h1>
        <div class="notifications-container">
            <div class="notification-settings">
                <h2>Configuración de Notificaciones</h2>
                <div class="server-status" id="serverStatus">
                    <span class="status-dot"></span>
                    <span class="status-text">Verificando conexión con el servidor...</span>
                </div>

                <div class="notification-option">
                    <label class="switch">
                        <input type="checkbox" id="enableNotifications">
                        <span class="slider round"></span>
                    </label>
                    <span>Activar notificaciones</span>
                </div>

                <div class="notification-types">
                    <h3>Tipos de Notificaciones</h3>
                    
                    <div class="notification-type">
                        <label class="switch">
                            <input type="checkbox" id="alarmNotifications" disabled>
                            <span class="slider round"></span>
                        </label>
                        <span>Notificaciones de alarma</span>
                    </div>

                    <div class="notification-type">
                        <label class="switch">
                            <input type="checkbox" id="timerNotifications" disabled>
                            <span class="slider round"></span>
                        </label>
                        <span>Notificaciones de temporizador</span>
                    </div>

                    <div class="notification-type">
                        <label class="switch">
                            <input type="checkbox" id="reminderNotifications" disabled>
                            <span class="slider round"></span>
                        </label>
                        <span>Recordatorios</span>
                    </div>
                </div>

                <div class="notification-preview">
                    <h3>Vista previa de notificación</h3>
                    <div class="preview-content">
                        <div class="preview-notification">
                            <div class="notification-header">
                                <img src="../assets/placeholder.svg" alt="Icono" class="notification-icon">
                                <div class="notification-title">Urukais Klick</div>
                                <div class="notification-time">ahora</div>
                            </div>
                            <div class="notification-body" id="previewBody">
                                🐸 Vista previa de la notificación 🐸
                            </div>
                        </div>
                        <button class="btn" id="testNotification">
                            <i class="fas fa-bell"></i> Probar notificación
                        </button>
                    </div>
                    
                    <div class="video-container" id="previewContainer">
                        <div class="video-wrapper">
                            <video id="previewVideo" src="" preload="auto">
                                Tu navegador no soporta el elemento de video.
                            </video>
                        </div>
                        <button class="btn btn-detener" onclick="stopPreview()">
                            <i class="fas fa-stop"></i> Detener
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-bottom">
        <p>© 2024 Urukais Klick. Todos los derechos reservados.</p>
        <p>Desarrollado con <i class="fas fa-heart"></i> <a href="https://silly-boba-dc057e.netlify.app/" target="blank">por Manuel Casimiro Carrasco</a> </p>
        <div class="legal-links">
            <a href="/legal/terminos.html">Términos y Condiciones</a> |
            <a href="/legal/privacidad.html">Política de Privacidad</a> |
            <a href="/legal/cookies.html">Política de Cookies</a>
        </div><br><br>
    </div> 
    <script src="../js/menu.js"></script>
    <script src="../js/themes.js"></script>
    <script src="../js/language.js"></script>
    <script src="../js/sounds.js"></script>
    <script>
        const enableNotifications = document.getElementById('enableNotifications');
        const alarmNotifications = document.getElementById('alarmNotifications');
        const timerNotifications = document.getElementById('timerNotifications');
        const reminderNotifications = document.getElementById('reminderNotifications');
        const testNotification = document.getElementById('testNotification');

        // Cargar configuración guardada
        document.addEventListener('DOMContentLoaded', () => {
            const settings = JSON.parse(localStorage.getItem('notificationSettings')) || {
                enabled: false,
                alarm: false,
                timer: false,
                reminder: false
            };

            enableNotifications.checked = settings.enabled;
            alarmNotifications.checked = settings.alarm;
            timerNotifications.checked = settings.timer;
            reminderNotifications.checked = settings.reminder;

            updateControls(settings.enabled);
        });

        function updateControls(enabled) {
            const controls = [alarmNotifications, timerNotifications, reminderNotifications, testNotification];
            controls.forEach(control => control.disabled = !enabled);
        }

        function saveSettings() {
            const settings = {
                enabled: enableNotifications.checked,
                alarm: alarmNotifications.checked,
                timer: timerNotifications.checked,
                reminder: reminderNotifications.checked
            };
            localStorage.setItem('notificationSettings', JSON.stringify(settings));
        }

        // Solicitar permisos de notificación
        enableNotifications.addEventListener('change', async () => {
            if (enableNotifications.checked) {
                try {
                    const permission = await Notification.requestPermission();
                    if (permission === 'granted') {
                        updateControls(true);
                        saveSettings();
                    } else {
                        enableNotifications.checked = false;
                        alert('Se requieren permisos de notificación para esta función');
                    }
                } catch (error) {
                    console.error('Error al solicitar permisos:', error);
                    enableNotifications.checked = false;
                }
            } else {
                updateControls(false);
                saveSettings();
            }
        });

        // Guardar cambios en las opciones
        [alarmNotifications, timerNotifications, reminderNotifications].forEach(control => {
            control.addEventListener('change', saveSettings);
        });

        // Función para detener la vista previa
        function stopPreview() {
            const video = document.getElementById('previewVideo');
            const container = document.getElementById('previewContainer');
            video.pause();
            video.currentTime = 0;
            container.classList.remove('active');
        }

        // Función para mostrar la vista previa
        function showPreview(sound) {
            const video = document.getElementById('previewVideo');
            const container = document.getElementById('previewContainer');
            const previewBody = document.getElementById('previewBody');

            // Actualizar el mensaje de la notificación
            previewBody.textContent = `🐸 ${sound.title} 🐸`;

            // Configurar y mostrar el video
            video.src = sound.file;
            container.style.display = 'block';
            requestAnimationFrame(() => {
                container.classList.add('active');
                video.play().catch(console.error);
            });
        }

        // Manejar el botón de prueba
        document.getElementById('testNotification').addEventListener('click', () => {
            if (Notification.permission === 'granted') {
                const savedSound = localStorage.getItem('selectedSound') || 'werewolf';
                const sound = availableSounds[savedSound];

                if (sound) {
                    // Mostrar notificación
                    new Notification('Urukais Klick', {
                        body: `🐸 ${sound.title} 🐸`,
                        icon: '../assets/placeholder.svg'
                    });

                    // Mostrar vista previa con video
                    showPreview(sound);
                }
            }
        });
    </script>
</body>
</html> 